# ğŸŒ Imagen base
FROM node:18-slim

# ğŸ”¹ Instalar OpenSSL (para que Prisma no de warning)
RUN apt-get update -y && apt-get install -y openssl

# ğŸ”¹ Crear directorio de trabajo
WORKDIR /app

# ğŸ”¹ Copiar package.json y package-lock.json
COPY package*.json ./

# ğŸ”¹ Copiar Prisma schema ANTES (para que npm install no falle)
COPY prisma ./prisma

# ğŸ”¹ Instalar dependencias
RUN npm install

# ğŸ”¹ Copiar todo el cÃ³digo del backend
COPY . .

# ğŸ”¹ Generar Prisma client
RUN npx prisma generate

# ğŸŒ Exponer puerto
EXPOSE 3000

# ğŸ”¹ Comando para arrancar el backend
CMD ["npm", "start"]
